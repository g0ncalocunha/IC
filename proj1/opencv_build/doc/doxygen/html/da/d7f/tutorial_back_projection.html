<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<title>OpenCV: Back Projection</title>
<link href="../../opencv.ico" rel="shortcut icon" type="image/x-icon" />
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../tutorial-utils.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "ams.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
//<![CDATA[
window.MathJax = {
    loader: {load: ['[tex]/ams']},
    tex: {
        packages: {'[+]': ['ams']},
        macros: {
            matTT: [ "\\[ \\left|\\begin{array}{ccc} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{array}\\right| \\]", 9],
            fork: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ \\end{array} \\right.", 4],
            forkthree: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ \\end{array} \\right.", 6],
            forkfour: ["\\left\\{ \\begin{array}{l l} #1 & \\mbox{#2}\\\\ #3 & \\mbox{#4}\\\\ #5 & \\mbox{#6}\\\\ #7 & \\mbox{#8}\\\\ \\end{array} \\right.", 8],
            vecthree: ["\\begin{bmatrix} #1\\\\ #2\\\\ #3 \\end{bmatrix}", 3],
            vecthreethree: ["\\begin{bmatrix} #1 & #2 & #3\\\\ #4 & #5 & #6\\\\ #7 & #8 & #9 \\end{bmatrix}", 9],
            cameramatrix: ["#1 = \\begin{bmatrix} f_x & 0 & c_x\\\\ 0 & f_y & c_y\\\\ 0 & 0 & 1 \\end{bmatrix}", 1],
            distcoeffs: ["(k_1, k_2, p_1, p_2[, k_3[, k_4, k_5, k_6 [, s_1, s_2, s_3, s_4[, \\tau_x, \\tau_y]]]]) \\text{ of 4, 5, 8, 12 or 14 elements}"],
            distcoeffsfisheye: ["(k_1, k_2, k_3, k_4)"],
            hdotsfor: ["\\dots", 1],
            mathbbm: ["\\mathbb{#1}", 1],
            bordermatrix: ["\\matrix{#1}", 1]
        },
        processEscapes: false
    }
};
//]]>
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<!--#include virtual="/google-search.html"-->
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../opencv-logo-small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenCV
   &#160;<span id="projectnumber">4.10.0-dev</span>
   </div>
   <div id="projectbrief">Open Source Computer Vision</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d9/df8/tutorial_root.html">OpenCV Tutorials</a></li><li class="navelem"><a class="el" href="../../d7/da8/tutorial_table_of_content_imgproc.html">Image Processing (imgproc module)</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Back Projection </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md443">Goal</a></li>
<li class="level1"><a href="#autotoc_md444">Theory</a><ul><li class="level2"><a href="#autotoc_md445">What is Back Projection?</a></li>
<li class="level2"><a href="#autotoc_md446">How does it work?</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md447">Code</a></li>
<li class="level1"><a href="#autotoc_md448">Explanation</a></li>
<li class="level1"><a href="#autotoc_md449">Results</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md__home_goncalo_MECT1_1_IC_proj1_opencv_4_x_doc_tutorials_imgproc_histograms_back_projection_back_projection"></a></p>
<p><b>Prev Tutorial:</b> <a class="el" href="../../d8/dc8/tutorial_histogram_comparison.html">Histogram Comparison</a> <br  />
<b>Next Tutorial:</b> <a class="el" href="../../de/da9/tutorial_template_matching.html">Template Matching</a> <br  />
 </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight"></th><th class="markdownTableHeadLeft"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">Original author   </td><td class="markdownTableBodyLeft">Ana Huam√°n    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">Compatibility   </td><td class="markdownTableBodyLeft">OpenCV &gt;= 3.0   </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md443"></a>
Goal</h1>
<p>In this tutorial you will learn:</p>
<ul>
<li>What is Back Projection and why it is useful</li>
<li>How to use the OpenCV function <a class="el" href="../../d6/dc7/group__imgproc__hist.html#ga3a0af640716b456c3d14af8aee12e3ca">cv::calcBackProject</a> to calculate Back Projection</li>
<li>How to mix different channels of an image by using the OpenCV function <a class="el" href="../../d2/de8/group__core__array.html#ga51d768c270a1cdd3497255017c4504be">cv::mixChannels</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md444"></a>
Theory</h1>
<h2><a class="anchor" id="autotoc_md445"></a>
What is Back Projection?</h2>
<ul>
<li>Back Projection is a way of recording how well the pixels of a given image fit the distribution of pixels in a histogram model.</li>
<li>To make it simpler: For Back Projection, you calculate the histogram model of a feature and then use it to find this feature in an image.</li>
<li>Application example: If you have a histogram of flesh color (say, a Hue-Saturation histogram ), then you can use it to find flesh color areas in an image:</li>
</ul>
<h2><a class="anchor" id="autotoc_md446"></a>
How does it work?</h2>
<ul>
<li>We explain this by using the skin example:</li>
<li>Let's say you have gotten a skin histogram (Hue-Saturation) based on the image below. The histogram besides is going to be our <em>model histogram</em> (which we know represents a sample of skin tonality). You applied some mask to capture only the histogram of the skin area: <img src="../../Back_Projection_Theory0.jpg" alt="" class="inline" title="T0"/> <img src="../../Back_Projection_Theory1.jpg" alt="" class="inline" title="T1"/></li>
<li>Now, let's imagine that you get another hand image (Test Image) like the one below: (with its respective histogram): <img src="../../Back_Projection_Theory2.jpg" alt="" class="inline" title="T2"/> <img src="../../Back_Projection_Theory3.jpg" alt="" class="inline" title="T3"/></li>
<li><p class="startli">What we want to do is to use our <em>model histogram</em> (that we know represents a skin tonality) to detect skin areas in our Test Image. Here are the steps</p><ol type="1">
<li>In each pixel of our Test Image (i.e. \(p(i,j)\) ), collect the data and find the correspondent bin location for that pixel (i.e. \(( h_{i,j}, s_{i,j} )\) ).</li>
<li>Lookup the <em>model histogram</em> in the correspondent bin - \(( h_{i,j}, s_{i,j} )\) - and read the bin value.</li>
<li>Store this bin value in a new image (<em>BackProjection</em>). Also, you may consider to normalize the <em>model histogram</em> first, so the output for the Test Image can be visible for you.</li>
<li><p class="startli">Applying the steps above, we get the following BackProjection image for our Test Image:</p>
<p class="startli"><img src="../../Back_Projection_Theory4.jpg" alt="" class="inline"/></p>
</li>
</ol>
<ol type="1">
<li>In terms of statistics, the values stored in <em>BackProjection</em> represent the <em>probability</em> that a pixel in <em>Test Image</em> belongs to a skin area, based on the <em>model histogram</em> that we use. For instance in our Test image, the brighter areas are more probable to be skin area (as they actually are), whereas the darker areas have less probability (notice that these "dark" areas belong to surfaces that have some shadow on it, which in turns affects the detection).</li>
</ol>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md447"></a>
Code</h1>
<ul>
<li><b>What does this program do?</b><ul>
<li>Loads an image</li>
<li>Convert the original to HSV format and separate only <em>Hue</em> channel to be used for the Histogram (using the OpenCV function <a class="el" href="../../d2/de8/group__core__array.html#ga51d768c270a1cdd3497255017c4504be">cv::mixChannels</a> )</li>
<li>Let the user to enter the number of bins to be used in the calculation of the histogram.</li>
<li>Calculate the histogram (and update it if the bins change) and the backprojection of the same image.</li>
<li>Display the backprojection and the histogram in windows.</li>
</ul>
</li>
</ul>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'><ul>
<li><b>Downloadable code</b>:<ul>
<li>Click <a href="https://github.com/opencv/opencv/tree/4.x/samples/cpp/tutorial_code/Histograms_Matching/calcBackProject_Demo1.cpp">here</a> for the basic version (explained in this tutorial).</li>
<li>For stuff slightly fancier (using H-S histograms and floodFill to define a mask for the skin area) you can check the <a href="https://github.com/opencv/opencv/tree/4.x/samples/cpp/tutorial_code/Histograms_Matching/calcBackProject_Demo2.cpp">improved demo</a></li>
<li>...or you can always check out the classical <a href="https://github.com/opencv/opencv/tree/4.x/samples/cpp/camshiftdemo.cpp">camshiftdemo</a> in samples.</li>
</ul>
</li>
<li><b>Code at glance:</b> <div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d1/d4f/imgproc_2include_2opencv2_2imgproc_8hpp.html">opencv2/imgproc.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d6/d87/imgcodecs_8hpp.html">opencv2/imgcodecs.hpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d4/dd5/highgui_8hpp.html">opencv2/highgui.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="../../d2/d75/namespacecv.html">cv</a>;</div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"> </div>
<div class="line">Mat hue;</div>
<div class="line"><span class="keywordtype">int</span> bins = 25;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> Hist_and_Backproj(<span class="keywordtype">int</span>, <span class="keywordtype">void</span>* );</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="../../dc/d89/highgui__qt_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>( <span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[] )</div>
<div class="line">{</div>
<div class="line">    CommandLineParser parser( argc, argv, <span class="stringliteral">&quot;{@input |Back_Projection_Theory0.jpg| input image}&quot;</span> );</div>
<div class="line">    <a class="code" href="../../d6/dba/group__core__utils__samples.html#gaa54838b2113b79689df232c190de969e">samples::addSamplesDataSearchSubDirectory</a>(<span class="stringliteral">&quot;doc/tutorials/imgproc/histograms/back_projection/images&quot;</span>);</div>
<div class="line">    Mat src = <a class="code" href="../../d4/da8/group__imgcodecs.html#gacbaa02cffc4ec2422dfa2e24412a99e2">imread</a>(<a class="code" href="../../d6/dba/group__core__utils__samples.html#ga3a33b00033b46c698ff6340d95569c13">samples::findFile</a>(parser.get&lt;<a class="code" href="../../dc/d84/group__core__basic.html#ga1f6634802eeadfd7245bc75cf3e216c2">String</a>&gt;( <span class="stringliteral">&quot;@input&quot;</span> )) );</div>
<div class="line">    <span class="keywordflow">if</span>( src.empty() )</div>
<div class="line">    {</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Could not open or find the image!\n&quot;</span> &lt;&lt; endl;</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot; &lt;Input image&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Mat hsv;</div>
<div class="line">    <a class="code" href="../../d8/d01/group__imgproc__color__conversions.html#gaf86c09fe702ed037c03c2bc603ceab14">cvtColor</a>( src, hsv, <a class="code" href="../../d8/d01/group__imgproc__color__conversions.html#gga4e0972be5de079fed4e3a10e24ef5ef0aa4a7f0ecf2e94150699e48c79139ee12">COLOR_BGR2HSV</a> );</div>
<div class="line"> </div>
<div class="line">    hue.create(hsv.size(), hsv.depth());</div>
<div class="line">    <span class="keywordtype">int</span> ch[] = { 0, 0 };</div>
<div class="line">    <a class="code" href="../../d2/de8/group__core__array.html#ga51d768c270a1cdd3497255017c4504be">mixChannels</a>( &amp;hsv, 1, &amp;hue, 1, ch, 1 );</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* window_image = <span class="stringliteral">&quot;Source image&quot;</span>;</div>
<div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga5afdf8410934fd099df85c75b2e0888b">namedWindow</a>( window_image );</div>
<div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#gaf78d2155d30b728fc413803745b67a9b">createTrackbar</a>(<span class="stringliteral">&quot;* Hue  bins: &quot;</span>, window_image, &amp;bins, 180, Hist_and_Backproj );</div>
<div class="line">    Hist_and_Backproj(0, 0);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">imshow</a>( window_image, src );</div>
<div class="line">    <span class="comment">// Wait until user exits the program</span></div>
<div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga5628525ad33f52eab17feebcfba38bd7">waitKey</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> Hist_and_Backproj(<span class="keywordtype">int</span>, <span class="keywordtype">void</span>* )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> histSize = <a class="code" href="../../db/de0/group__core__utils.html#gafa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>( bins, 2 );</div>
<div class="line">    <span class="keywordtype">float</span> hue_range[] = { 0, 180 };</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">float</span>* ranges[] = { hue_range };</div>
<div class="line"> </div>
<div class="line">    Mat hist;</div>
<div class="line">    <a class="code" href="../../d6/dc7/group__imgproc__hist.html#ga4b2b5fd75503ff9e6844cc4dcdaed35d">calcHist</a>( &amp;hue, 1, 0, Mat(), hist, 1, &amp;histSize, ranges, <span class="keyword">true</span>, <span class="keyword">false</span> );</div>
<div class="line">    <a class="code" href="../../dc/d84/group__core__basic.html#ga766333b5fb9fea02d355fa0e0ffbf7ac">normalize</a>( hist, hist, 0, 255, <a class="code" href="../../d2/de8/group__core__array.html#ggad12cefbcb5291cf958a85b4b67b6149fa9f0c1c342a18114d47b516a88e29822e">NORM_MINMAX</a>, -1, Mat() );</div>
<div class="line"> </div>
<div class="line">    Mat backproj;</div>
<div class="line">    <a class="code" href="../../d6/dc7/group__imgproc__hist.html#ga3a0af640716b456c3d14af8aee12e3ca">calcBackProject</a>( &amp;hue, 1, 0, hist, backproj, ranges, 1, <span class="keyword">true</span> );</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">imshow</a>( <span class="stringliteral">&quot;BackProj&quot;</span>, backproj );</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> w = 400, h = 400;</div>
<div class="line">    <span class="keywordtype">int</span> bin_w = <a class="code" href="../../db/de0/group__core__utils.html#ga085eca238176984a0b72df2818598d85">cvRound</a>( (<span class="keywordtype">double</span>) w / histSize );</div>
<div class="line">    Mat histImg = <a class="code" href="../../d3/d63/classcv_1_1Mat.html#a56daa006391a670e9cb0cd08e3168c99">Mat::zeros</a>( h, w, <a class="code" href="../../d1/d1b/group__core__hal__interface.html#ga88c4cd9de76f678f33928ef1e3f96047">CV_8UC3</a> );</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; bins; i++)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="../../d6/d6e/group__imgproc__draw.html#ga07d2f74cadcf8e305e810ce8eed13bc9">rectangle</a>( histImg, <a class="code" href="../../dc/d84/group__core__basic.html#ga1e83eafb2d26b3c93f09e8338bcab192">Point</a>( i*bin_w, h ), <a class="code" href="../../dc/d84/group__core__basic.html#ga1e83eafb2d26b3c93f09e8338bcab192">Point</a>( (i+1)*bin_w, h - <a class="code" href="../../db/de0/group__core__utils.html#ga085eca238176984a0b72df2818598d85">cvRound</a>( hist.at&lt;<span class="keywordtype">float</span>&gt;(i)*h/255.0 ) ),</div>
<div class="line">                   <a class="code" href="../../dc/d84/group__core__basic.html#ga599fe92e910c027be274233eccad7beb">Scalar</a>( 0, 0, 255 ), <a class="code" href="../../d6/d6e/group__imgproc__draw.html#ggaf076ef45de481ac96e0ab3dc2c29a777a89c5f6beef080e6df347167f85e07b9e">FILLED</a> );</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">imshow</a>( <span class="stringliteral">&quot;Histogram&quot;</span>, histImg );</div>
<div class="line">}</div>
<div class="ttc" id="aclasscv_1_1Mat_html_a56daa006391a670e9cb0cd08e3168c99"><div class="ttname"><a href="../../d3/d63/classcv_1_1Mat.html#a56daa006391a670e9cb0cd08e3168c99">cv::Mat::zeros</a></div><div class="ttdeci">static CV_NODISCARD_STD MatExpr zeros(int rows, int cols, int type)</div><div class="ttdoc">Returns a zero array of the specified size and type.</div></div>
<div class="ttc" id="agroup__core__array_html_ga51d768c270a1cdd3497255017c4504be"><div class="ttname"><a href="../../d2/de8/group__core__array.html#ga51d768c270a1cdd3497255017c4504be">cv::mixChannels</a></div><div class="ttdeci">void mixChannels(const Mat *src, size_t nsrcs, Mat *dst, size_t ndsts, const int *fromTo, size_t npairs)</div><div class="ttdoc">Copies specified channels from input arrays to the specified channels of output arrays.</div></div>
<div class="ttc" id="agroup__core__array_html_ggad12cefbcb5291cf958a85b4b67b6149fa9f0c1c342a18114d47b516a88e29822e"><div class="ttname"><a href="../../d2/de8/group__core__array.html#ggad12cefbcb5291cf958a85b4b67b6149fa9f0c1c342a18114d47b516a88e29822e">cv::NORM_MINMAX</a></div><div class="ttdeci">@ NORM_MINMAX</div><div class="ttdoc">flag</div><div class="ttdef"><b>Definition:</b> base.hpp:207</div></div>
<div class="ttc" id="agroup__core__basic_html_ga1e83eafb2d26b3c93f09e8338bcab192"><div class="ttname"><a href="../../dc/d84/group__core__basic.html#ga1e83eafb2d26b3c93f09e8338bcab192">cv::Point</a></div><div class="ttdeci">Point2i Point</div><div class="ttdef"><b>Definition:</b> types.hpp:209</div></div>
<div class="ttc" id="agroup__core__basic_html_ga1f6634802eeadfd7245bc75cf3e216c2"><div class="ttname"><a href="../../dc/d84/group__core__basic.html#ga1f6634802eeadfd7245bc75cf3e216c2">cv::String</a></div><div class="ttdeci">std::string String</div><div class="ttdef"><b>Definition:</b> cvstd.hpp:149</div></div>
<div class="ttc" id="agroup__core__basic_html_ga599fe92e910c027be274233eccad7beb"><div class="ttname"><a href="../../dc/d84/group__core__basic.html#ga599fe92e910c027be274233eccad7beb">cv::Scalar</a></div><div class="ttdeci">Scalar_&lt; double &gt; Scalar</div><div class="ttdef"><b>Definition:</b> types.hpp:709</div></div>
<div class="ttc" id="agroup__core__basic_html_ga766333b5fb9fea02d355fa0e0ffbf7ac"><div class="ttname"><a href="../../dc/d84/group__core__basic.html#ga766333b5fb9fea02d355fa0e0ffbf7ac">cv::normalize</a></div><div class="ttdeci">Vec&lt; _Tp, cn &gt; normalize(const Vec&lt; _Tp, cn &gt; &amp;v)</div></div>
<div class="ttc" id="agroup__core__hal__interface_html_ga88c4cd9de76f678f33928ef1e3f96047"><div class="ttname"><a href="../../d1/d1b/group__core__hal__interface.html#ga88c4cd9de76f678f33928ef1e3f96047">CV_8UC3</a></div><div class="ttdeci">#define CV_8UC3</div><div class="ttdef"><b>Definition:</b> interface.h:90</div></div>
<div class="ttc" id="agroup__core__utils__samples_html_ga3a33b00033b46c698ff6340d95569c13"><div class="ttname"><a href="../../d6/dba/group__core__utils__samples.html#ga3a33b00033b46c698ff6340d95569c13">cv::samples::findFile</a></div><div class="ttdeci">cv::String findFile(const cv::String &amp;relative_path, bool required=true, bool silentMode=false)</div><div class="ttdoc">Try to find requested data file.</div></div>
<div class="ttc" id="agroup__core__utils__samples_html_gaa54838b2113b79689df232c190de969e"><div class="ttname"><a href="../../d6/dba/group__core__utils__samples.html#gaa54838b2113b79689df232c190de969e">cv::samples::addSamplesDataSearchSubDirectory</a></div><div class="ttdeci">void addSamplesDataSearchSubDirectory(const cv::String &amp;subdir)</div><div class="ttdoc">Append samples search data sub directory.</div></div>
<div class="ttc" id="agroup__core__utils_html_ga085eca238176984a0b72df2818598d85"><div class="ttname"><a href="../../db/de0/group__core__utils.html#ga085eca238176984a0b72df2818598d85">cvRound</a></div><div class="ttdeci">int cvRound(double value)</div><div class="ttdoc">Rounds floating-point number to the nearest integer.</div><div class="ttdef"><b>Definition:</b> fast_math.hpp:200</div></div>
<div class="ttc" id="agroup__core__utils_html_gafa99ec4acc4ecb2dc3c2d05da15d0e3f"><div class="ttname"><a href="../../db/de0/group__core__utils.html#gafa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a></div><div class="ttdeci">#define MAX(a, b)</div><div class="ttdef"><b>Definition:</b> cvdef.h:518</div></div>
<div class="ttc" id="agroup__highgui_html_ga453d42fe4cb60e5723281a89973ee563"><div class="ttname"><a href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv::imshow</a></div><div class="ttdeci">void imshow(const String &amp;winname, InputArray mat)</div><div class="ttdoc">Displays an image in the specified window.</div></div>
<div class="ttc" id="agroup__highgui_html_ga5628525ad33f52eab17feebcfba38bd7"><div class="ttname"><a href="../../d7/dfc/group__highgui.html#ga5628525ad33f52eab17feebcfba38bd7">cv::waitKey</a></div><div class="ttdeci">int waitKey(int delay=0)</div><div class="ttdoc">Waits for a pressed key.</div></div>
<div class="ttc" id="agroup__highgui_html_ga5afdf8410934fd099df85c75b2e0888b"><div class="ttname"><a href="../../d7/dfc/group__highgui.html#ga5afdf8410934fd099df85c75b2e0888b">cv::namedWindow</a></div><div class="ttdeci">void namedWindow(const String &amp;winname, int flags=WINDOW_AUTOSIZE)</div><div class="ttdoc">Creates a window.</div></div>
<div class="ttc" id="agroup__highgui_html_gaf78d2155d30b728fc413803745b67a9b"><div class="ttname"><a href="../../d7/dfc/group__highgui.html#gaf78d2155d30b728fc413803745b67a9b">cv::createTrackbar</a></div><div class="ttdeci">int createTrackbar(const String &amp;trackbarname, const String &amp;winname, int *value, int count, TrackbarCallback onChange=0, void *userdata=0)</div><div class="ttdoc">Creates a trackbar and attaches it to the specified window.</div></div>
<div class="ttc" id="agroup__imgcodecs_html_gacbaa02cffc4ec2422dfa2e24412a99e2"><div class="ttname"><a href="../../d4/da8/group__imgcodecs.html#gacbaa02cffc4ec2422dfa2e24412a99e2">cv::imread</a></div><div class="ttdeci">CV_EXPORTS_W Mat imread(const String &amp;filename, int flags=IMREAD_COLOR_BGR)</div><div class="ttdoc">Loads an image from a file.</div></div>
<div class="ttc" id="agroup__imgproc__color__conversions_html_gaf86c09fe702ed037c03c2bc603ceab14"><div class="ttname"><a href="../../d8/d01/group__imgproc__color__conversions.html#gaf86c09fe702ed037c03c2bc603ceab14">cv::cvtColor</a></div><div class="ttdeci">void cvtColor(InputArray src, OutputArray dst, int code, int dstCn=0, AlgorithmHint hint=cv::ALGO_HINT_DEFAULT)</div><div class="ttdoc">Converts an image from one color space to another.</div></div>
<div class="ttc" id="agroup__imgproc__color__conversions_html_gga4e0972be5de079fed4e3a10e24ef5ef0aa4a7f0ecf2e94150699e48c79139ee12"><div class="ttname"><a href="../../d8/d01/group__imgproc__color__conversions.html#gga4e0972be5de079fed4e3a10e24ef5ef0aa4a7f0ecf2e94150699e48c79139ee12">cv::COLOR_BGR2HSV</a></div><div class="ttdeci">@ COLOR_BGR2HSV</div><div class="ttdoc">convert RGB/BGR to HSV (hue saturation value) with H range 0..180 if 8 bit image, color conversions</div><div class="ttdef"><b>Definition:</b> imgproc.hpp:598</div></div>
<div class="ttc" id="agroup__imgproc__draw_html_ga07d2f74cadcf8e305e810ce8eed13bc9"><div class="ttname"><a href="../../d6/d6e/group__imgproc__draw.html#ga07d2f74cadcf8e305e810ce8eed13bc9">cv::rectangle</a></div><div class="ttdeci">void rectangle(InputOutputArray img, Point pt1, Point pt2, const Scalar &amp;color, int thickness=1, int lineType=LINE_8, int shift=0)</div><div class="ttdoc">Draws a simple, thick, or filled up-right rectangle.</div></div>
<div class="ttc" id="agroup__imgproc__draw_html_ggaf076ef45de481ac96e0ab3dc2c29a777a89c5f6beef080e6df347167f85e07b9e"><div class="ttname"><a href="../../d6/d6e/group__imgproc__draw.html#ggaf076ef45de481ac96e0ab3dc2c29a777a89c5f6beef080e6df347167f85e07b9e">cv::FILLED</a></div><div class="ttdeci">@ FILLED</div><div class="ttdef"><b>Definition:</b> imgproc.hpp:891</div></div>
<div class="ttc" id="agroup__imgproc__hist_html_ga3a0af640716b456c3d14af8aee12e3ca"><div class="ttname"><a href="../../d6/dc7/group__imgproc__hist.html#ga3a0af640716b456c3d14af8aee12e3ca">cv::calcBackProject</a></div><div class="ttdeci">void calcBackProject(const Mat *images, int nimages, const int *channels, InputArray hist, OutputArray backProject, const float **ranges, double scale=1, bool uniform=true)</div><div class="ttdoc">Calculates the back projection of a histogram.</div></div>
<div class="ttc" id="agroup__imgproc__hist_html_ga4b2b5fd75503ff9e6844cc4dcdaed35d"><div class="ttname"><a href="../../d6/dc7/group__imgproc__hist.html#ga4b2b5fd75503ff9e6844cc4dcdaed35d">cv::calcHist</a></div><div class="ttdeci">void calcHist(const Mat *images, int nimages, const int *channels, InputArray mask, OutputArray hist, int dims, const int *histSize, const float **ranges, bool uniform=true, bool accumulate=false)</div><div class="ttdoc">Calculates a histogram of a set of arrays.</div></div>
<div class="ttc" id="ahighgui_8hpp_html"><div class="ttname"><a href="../../d4/dd5/highgui_8hpp.html">highgui.hpp</a></div></div>
<div class="ttc" id="ahighgui__qt_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="../../dc/d89/highgui__qt_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> highgui_qt.cpp:3</div></div>
<div class="ttc" id="aimgcodecs_8hpp_html"><div class="ttname"><a href="../../d6/d87/imgcodecs_8hpp.html">imgcodecs.hpp</a></div></div>
<div class="ttc" id="aimgproc_2include_2opencv2_2imgproc_8hpp_html"><div class="ttname"><a href="../../d1/d4f/imgproc_2include_2opencv2_2imgproc_8hpp.html">imgproc.hpp</a></div></div>
<div class="ttc" id="anamespacecv_html"><div class="ttname"><a href="../../d2/d75/namespacecv.html">cv</a></div><div class="ttdoc">&quot;black box&quot; representation of the file storage associated with a file on disk.</div><div class="ttdef"><b>Definition:</b> affine.hpp:52</div></div>
</div><!-- fragment -->  </div> </li>
</ul>
 <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'><ul>
<li><b>Downloadable code</b>:<ul>
<li>Click <a href="https://github.com/opencv/opencv/tree/4.x/samples/java/tutorial_code/Histograms_Matching/back_projection/CalcBackProjectDemo1.java">here</a> for the basic version (explained in this tutorial).</li>
<li>For stuff slightly fancier (using H-S histograms and floodFill to define a mask for the skin area) you can check the <a href="https://github.com/opencv/opencv/tree/4.x/samples/java/tutorial_code/Histograms_Matching/back_projection/CalcBackProjectDemo2.java">improved demo</a></li>
<li>...or you can always check out the classical <a href="https://github.com/opencv/opencv/tree/4.x/samples/cpp/camshiftdemo.cpp">camshiftdemo</a> in samples.</li>
</ul>
</li>
<li><b>Code at glance:</b> <div class="fragment"><div class="line"><span class="keyword">import</span> java.awt.BorderLayout;</div>
<div class="line"><span class="keyword">import</span> java.awt.Container;</div>
<div class="line"><span class="keyword">import</span> java.awt.Image;</div>
<div class="line"><span class="keyword">import</span> java.util.Arrays;</div>
<div class="line"><span class="keyword">import</span> java.util.List;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> javax.swing.BoxLayout;</div>
<div class="line"><span class="keyword">import</span> javax.swing.ImageIcon;</div>
<div class="line"><span class="keyword">import</span> javax.swing.JFrame;</div>
<div class="line"><span class="keyword">import</span> javax.swing.JLabel;</div>
<div class="line"><span class="keyword">import</span> javax.swing.JPanel;</div>
<div class="line"><span class="keyword">import</span> javax.swing.JSlider;</div>
<div class="line"><span class="keyword">import</span> javax.swing.event.ChangeEvent;</div>
<div class="line"><span class="keyword">import</span> javax.swing.event.ChangeListener;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">import</span> org.opencv.core.Core;</div>
<div class="line"><span class="keyword">import</span> org.opencv.core.CvType;</div>
<div class="line"><span class="keyword">import</span> org.opencv.core.Mat;</div>
<div class="line"><span class="keyword">import</span> org.opencv.core.MatOfFloat;</div>
<div class="line"><span class="keyword">import</span> org.opencv.core.MatOfInt;</div>
<div class="line"><span class="keyword">import</span> org.opencv.core.Point;</div>
<div class="line"><span class="keyword">import</span> org.opencv.core.Scalar;</div>
<div class="line"><span class="keyword">import</span> org.opencv.highgui.HighGui;</div>
<div class="line"><span class="keyword">import</span> org.opencv.imgcodecs.Imgcodecs;</div>
<div class="line"><span class="keyword">import</span> org.opencv.imgproc.Imgproc;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>CalcBackProject1 {</div>
<div class="line">    <span class="keyword">private</span> Mat hue;</div>
<div class="line">    <span class="keyword">private</span> Mat histImg = <span class="keyword">new</span> Mat();</div>
<div class="line">    <span class="keyword">private</span> JFrame frame;</div>
<div class="line">    <span class="keyword">private</span> JLabel imgLabel;</div>
<div class="line">    <span class="keyword">private</span> JLabel backprojLabel;</div>
<div class="line">    <span class="keyword">private</span> JLabel histImgLabel;</div>
<div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keywordtype">int</span> MAX_SLIDER = 180;</div>
<div class="line">    <span class="keyword">private</span> <span class="keywordtype">int</span> bins = 25;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> CalcBackProject1(<a class="code" href="../../dc/d84/group__core__basic.html#ga1f6634802eeadfd7245bc75cf3e216c2">String</a>[] args) {</div>
<div class="line">        <span class="keywordflow">if</span> (args.length != 1) {</div>
<div class="line">            System.err.println(<span class="stringliteral">&quot;You must supply one argument that corresponds to the path to the image.&quot;</span>);</div>
<div class="line">            System.exit(0);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        Mat src = Imgcodecs.imread(args[0]);</div>
<div class="line">        <span class="keywordflow">if</span> (src.empty()) {</div>
<div class="line">            System.err.println(<span class="stringliteral">&quot;Empty image: &quot;</span> + args[0]);</div>
<div class="line">            System.exit(0);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        Mat hsv = <span class="keyword">new</span> Mat();</div>
<div class="line">        Imgproc.cvtColor(src, hsv, Imgproc.COLOR_BGR2HSV);</div>
<div class="line"> </div>
<div class="line">        hue = <span class="keyword">new</span> Mat(hsv.size(), hsv.depth());</div>
<div class="line">        Core.mixChannels(Arrays.asList(hsv), Arrays.asList(hue), <span class="keyword">new</span> MatOfInt(0, 0));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Create and set up the window.</span></div>
<div class="line">        frame = <span class="keyword">new</span> JFrame(<span class="stringliteral">&quot;Back Projection 1 demo&quot;</span>);</div>
<div class="line">        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</div>
<div class="line">        <span class="comment">// Set up the content pane.</span></div>
<div class="line">        Image img = HighGui.toBufferedImage(src);</div>
<div class="line">        addComponentsToPane(frame.getContentPane(), img);</div>
<div class="line">        <span class="comment">// Use the content pane&#39;s default BorderLayout. No need for</span></div>
<div class="line">        <span class="comment">// setLayout(new BorderLayout());</span></div>
<div class="line">        <span class="comment">// Display the window.</span></div>
<div class="line">        frame.pack();</div>
<div class="line">        frame.setVisible(<span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span> <span class="keywordtype">void</span> addComponentsToPane(Container pane, Image img) {</div>
<div class="line">        <span class="keywordflow">if</span> (!(pane.getLayout() instanceof BorderLayout)) {</div>
<div class="line">            pane.add(<span class="keyword">new</span> JLabel(<span class="stringliteral">&quot;Container doesn&#39;t use BorderLayout!&quot;</span>));</div>
<div class="line">            <span class="keywordflow">return</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        JPanel sliderPanel = <span class="keyword">new</span> JPanel();</div>
<div class="line">        sliderPanel.setLayout(<span class="keyword">new</span> BoxLayout(sliderPanel, BoxLayout.PAGE_AXIS));</div>
<div class="line"> </div>
<div class="line">        sliderPanel.add(<span class="keyword">new</span> JLabel(<span class="stringliteral">&quot;* Hue  bins: &quot;</span>));</div>
<div class="line">        JSlider slider = <span class="keyword">new</span> JSlider(0, MAX_SLIDER, bins);</div>
<div class="line">        slider.setMajorTickSpacing(25);</div>
<div class="line">        slider.setMinorTickSpacing(5);</div>
<div class="line">        slider.setPaintTicks(<span class="keyword">true</span>);</div>
<div class="line">        slider.setPaintLabels(<span class="keyword">true</span>);</div>
<div class="line">        slider.addChangeListener(<span class="keyword">new</span> ChangeListener() {</div>
<div class="line">            @Override</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">void</span> stateChanged(ChangeEvent e) {</div>
<div class="line">                JSlider source = (JSlider) e.getSource();</div>
<div class="line">                bins = source.getValue();</div>
<div class="line">                update();</div>
<div class="line">            }</div>
<div class="line">        });</div>
<div class="line">        sliderPanel.add(slider);</div>
<div class="line">        pane.add(sliderPanel, BorderLayout.PAGE_START);</div>
<div class="line"> </div>
<div class="line">        JPanel imgPanel = <span class="keyword">new</span> JPanel();</div>
<div class="line">        imgLabel = <span class="keyword">new</span> JLabel(<span class="keyword">new</span> ImageIcon(img));</div>
<div class="line">        imgPanel.add(imgLabel);</div>
<div class="line"> </div>
<div class="line">        backprojLabel = <span class="keyword">new</span> JLabel();</div>
<div class="line">        imgPanel.add(backprojLabel);</div>
<div class="line"> </div>
<div class="line">        histImgLabel = <span class="keyword">new</span> JLabel();</div>
<div class="line">        imgPanel.add(histImgLabel);</div>
<div class="line">        pane.add(imgPanel, BorderLayout.CENTER);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span> <span class="keywordtype">void</span> update() {</div>
<div class="line">        <span class="keywordtype">int</span> histSize = Math.max(bins, 2);</div>
<div class="line">        <span class="keywordtype">float</span>[] hueRange = {0, 180};</div>
<div class="line"> </div>
<div class="line">        Mat hist = <span class="keyword">new</span> Mat();</div>
<div class="line">        List&lt;Mat&gt; hueList = Arrays.asList(hue);</div>
<div class="line">        Imgproc.calcHist(hueList, <span class="keyword">new</span> MatOfInt(0), <span class="keyword">new</span> Mat(), hist, <span class="keyword">new</span> MatOfInt(histSize), <span class="keyword">new</span> MatOfFloat(hueRange), <span class="keyword">false</span>);</div>
<div class="line">        Core.normalize(hist, hist, 0, 255, Core.NORM_MINMAX);</div>
<div class="line"> </div>
<div class="line">        Mat backproj = <span class="keyword">new</span> Mat();</div>
<div class="line">        Imgproc.calcBackProject(hueList, <span class="keyword">new</span> MatOfInt(0), hist, backproj, <span class="keyword">new</span> MatOfFloat(hueRange), 1);</div>
<div class="line"> </div>
<div class="line">        Image backprojImg = HighGui.toBufferedImage(backproj);</div>
<div class="line">        backprojLabel.setIcon(<span class="keyword">new</span> ImageIcon(backprojImg));</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">int</span> w = 400, h = 400;</div>
<div class="line">        <span class="keywordtype">int</span> binW = (int) Math.round((<span class="keywordtype">double</span>) w / histSize);</div>
<div class="line">        histImg = Mat.zeros(h, w, CvType.CV_8UC3);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">float</span>[] histData = <span class="keyword">new</span> <span class="keywordtype">float</span>[(int) (hist.total() * hist.channels())];</div>
<div class="line">        hist.get(0, 0, histData);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; bins; i++) {</div>
<div class="line">            Imgproc.rectangle(histImg, <span class="keyword">new</span> <a class="code" href="../../dc/d84/group__core__basic.html#ga1e83eafb2d26b3c93f09e8338bcab192">Point</a>(i * binW, h),</div>
<div class="line">                    <span class="keyword">new</span> <a class="code" href="../../dc/d84/group__core__basic.html#ga1e83eafb2d26b3c93f09e8338bcab192">Point</a>((i + 1) * binW, h - Math.round(histData[i] * h / 255.0)), <span class="keyword">new</span> <a class="code" href="../../dc/d84/group__core__basic.html#ga599fe92e910c027be274233eccad7beb">Scalar</a>(0, 0, 255), Imgproc.FILLED);</div>
<div class="line">        }</div>
<div class="line">        Image histImage = HighGui.toBufferedImage(histImg);</div>
<div class="line">        histImgLabel.setIcon(<span class="keyword">new</span> ImageIcon(histImage));</div>
<div class="line"> </div>
<div class="line">        frame.repaint();</div>
<div class="line">        frame.pack();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>CalcBackProjectDemo1 {</div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="../../dc/d89/highgui__qt_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<a class="code" href="../../dc/d84/group__core__basic.html#ga1f6634802eeadfd7245bc75cf3e216c2">String</a>[] args) {</div>
<div class="line">        <span class="comment">// Load the native OpenCV library</span></div>
<div class="line">        System.loadLibrary(Core.NATIVE_LIBRARY_NAME);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Schedule a job for the event dispatch thread:</span></div>
<div class="line">        <span class="comment">// creating and showing this application&#39;s GUI.</span></div>
<div class="line">        javax.swing.SwingUtilities.invokeLater(<span class="keyword">new</span> Runnable() {</div>
<div class="line">            @Override</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">void</span> run() {</div>
<div class="line">                <span class="keyword">new</span> CalcBackProject1(args);</div>
<div class="line">            }</div>
<div class="line">        });</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->  </div> </li>
</ul>
 <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'><ul>
<li><b>Downloadable code</b>:<ul>
<li>Click <a href="https://github.com/opencv/opencv/tree/4.x/samples/python/tutorial_code/Histograms_Matching/back_projection/calcBackProject_Demo1.py">here</a> for the basic version (explained in this tutorial).</li>
<li>For stuff slightly fancier (using H-S histograms and floodFill to define a mask for the skin area) you can check the <a href="https://github.com/opencv/opencv/tree/4.x/samples/python/tutorial_code/Histograms_Matching/back_projection/calcBackProject_Demo2.py">improved demo</a></li>
<li>...or you can always check out the classical <a href="https://github.com/opencv/opencv/tree/4.x/samples/cpp/camshiftdemo.cpp">camshiftdemo</a> in samples.</li>
</ul>
</li>
<li><b>Code at glance:</b> <div class="fragment"><div class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</div>
<div class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> division</div>
<div class="line"><span class="keyword">import</span> cv2 <span class="keyword">as</span> cv</div>
<div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div>
<div class="line"><span class="keyword">import</span> argparse</div>
<div class="line"> </div>
<div class="line"><span class="keyword">def </span>Hist_and_Backproj(val):</div>
<div class="line">    </div>
<div class="line">    bins = val</div>
<div class="line">    histSize = <a class="code" href="../../d1/d10/classcv_1_1MatExpr.html#a6dff8b6e9105b6d817b493e7be157c90">max</a>(bins, 2)</div>
<div class="line">    ranges = [0, 180] <span class="comment"># hue_range</span></div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line">    </div>
<div class="line">    hist = <a class="code" href="../../d6/dc7/group__imgproc__hist.html#ga4b2b5fd75503ff9e6844cc4dcdaed35d">cv.calcHist</a>([hue], [0], <span class="keywordtype">None</span>, [histSize], ranges, accumulate=<span class="keyword">False</span>)</div>
<div class="line">    <a class="code" href="../../dc/d84/group__core__basic.html#ga766333b5fb9fea02d355fa0e0ffbf7ac">cv.normalize</a>(hist, hist, alpha=0, beta=255, norm_type=cv.NORM_MINMAX)</div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line">    </div>
<div class="line">    backproj = <a class="code" href="../../d6/dc7/group__imgproc__hist.html#ga3a0af640716b456c3d14af8aee12e3ca">cv.calcBackProject</a>([hue], [0], hist, ranges, scale=1)</div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line">    </div>
<div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv.imshow</a>(<span class="stringliteral">&#39;BackProj&#39;</span>, backproj)</div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line">    </div>
<div class="line">    w = 400</div>
<div class="line">    h = 400</div>
<div class="line">    bin_w = int(round(w / histSize))</div>
<div class="line">    histImg = np.zeros((h, w, 3), dtype=np.uint8)</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(bins):</div>
<div class="line">        <a class="code" href="../../d6/d6e/group__imgproc__draw.html#ga07d2f74cadcf8e305e810ce8eed13bc9">cv.rectangle</a>(histImg, (i*bin_w, h), ( (i+1)*bin_w, h - int(np.round( hist[i]*h/255.0 )) ), (0, 0, 255), cv.FILLED)</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv.imshow</a>(<span class="stringliteral">&#39;Histogram&#39;</span>, histImg)</div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">parser = argparse.ArgumentParser(description=<span class="stringliteral">&#39;Code for Back Projection tutorial.&#39;</span>)</div>
<div class="line">parser.add_argument(<span class="stringliteral">&#39;--input&#39;</span>, help=<span class="stringliteral">&#39;Path to input image.&#39;</span>, default=<span class="stringliteral">&#39;home.jpg&#39;</span>)</div>
<div class="line">args = parser.parse_args()</div>
<div class="line"> </div>
<div class="line">src = <a class="code" href="../../d4/da8/group__imgcodecs.html#gacbaa02cffc4ec2422dfa2e24412a99e2">cv.imread</a>(<a class="code" href="../../d6/dba/group__core__utils__samples.html#ga3a33b00033b46c698ff6340d95569c13">cv.samples.findFile</a>(args.input))</div>
<div class="line"><span class="keywordflow">if</span> src <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line">    <a class="code" href="../../df/d57/namespacecv_1_1dnn.html#a43417dcaeb3c1e2a09b9d948e234c366">print</a>(<span class="stringliteral">&#39;Could not open or find the image:&#39;</span>, args.input)</div>
<div class="line">    exit(0)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">hsv = <a class="code" href="../../d8/d01/group__imgproc__color__conversions.html#gaf86c09fe702ed037c03c2bc603ceab14">cv.cvtColor</a>(src, cv.COLOR_BGR2HSV)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">ch = (0, 0)</div>
<div class="line">hue = np.empty(hsv.shape, hsv.dtype)</div>
<div class="line"><a class="code" href="../../d2/de8/group__core__array.html#ga51d768c270a1cdd3497255017c4504be">cv.mixChannels</a>([hsv], [hue], ch)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">window_image = <span class="stringliteral">&#39;Source image&#39;</span></div>
<div class="line"><a class="code" href="../../d7/dfc/group__highgui.html#ga5afdf8410934fd099df85c75b2e0888b">cv.namedWindow</a>(window_image)</div>
<div class="line">bins = 25</div>
<div class="line"><a class="code" href="../../d7/dfc/group__highgui.html#gaf78d2155d30b728fc413803745b67a9b">cv.createTrackbar</a>(<span class="stringliteral">&#39;* Hue  bins: &#39;</span>, window_image, bins, 180, Hist_and_Backproj )</div>
<div class="line">Hist_and_Backproj(bins)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv.imshow</a>(window_image, src)</div>
<div class="line"><a class="code" href="../../d7/dfc/group__highgui.html#ga5628525ad33f52eab17feebcfba38bd7">cv.waitKey</a>()</div>
<div class="line"> </div>
<div class="ttc" id="aclasscv_1_1MatExpr_html_a6dff8b6e9105b6d817b493e7be157c90"><div class="ttname"><a href="../../d1/d10/classcv_1_1MatExpr.html#a6dff8b6e9105b6d817b493e7be157c90">cv::MatExpr::max</a></div><div class="ttdeci">MatExpr max(const Mat &amp;a, const Mat &amp;b)</div></div>
<div class="ttc" id="anamespacecv_1_1dnn_html_a43417dcaeb3c1e2a09b9d948e234c366"><div class="ttname"><a href="../../df/d57/namespacecv_1_1dnn.html#a43417dcaeb3c1e2a09b9d948e234c366">cv::dnn::print</a></div><div class="ttdeci">static void print(const std::vector&lt; _Tp &gt; &amp;shape, const String &amp;name=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> shape_utils.hpp:228</div></div>
</div><!-- fragment -->  </div> </li>
</ul>
<h1><a class="anchor" id="autotoc_md448"></a>
Explanation</h1>
<ul>
<li>Read the input image:</li>
</ul>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    CommandLineParser parser( argc, argv, <span class="stringliteral">&quot;{@input |Back_Projection_Theory0.jpg| input image}&quot;</span> );</div>
<div class="line">    <a class="code" href="../../d6/dba/group__core__utils__samples.html#gaa54838b2113b79689df232c190de969e">samples::addSamplesDataSearchSubDirectory</a>(<span class="stringliteral">&quot;doc/tutorials/imgproc/histograms/back_projection/images&quot;</span>);</div>
<div class="line">    Mat src = <a class="code" href="../../d4/da8/group__imgcodecs.html#gacbaa02cffc4ec2422dfa2e24412a99e2">imread</a>(<a class="code" href="../../d6/dba/group__core__utils__samples.html#ga3a33b00033b46c698ff6340d95569c13">samples::findFile</a>(parser.get&lt;<a class="code" href="../../dc/d84/group__core__basic.html#ga1f6634802eeadfd7245bc75cf3e216c2">String</a>&gt;( <span class="stringliteral">&quot;@input&quot;</span> )) );</div>
<div class="line">    <span class="keywordflow">if</span>( src.empty() )</div>
<div class="line">    {</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Could not open or find the image!\n&quot;</span> &lt;&lt; endl;</div>
<div class="line">        cout &lt;&lt; <span class="stringliteral">&quot;Usage: &quot;</span> &lt;&lt; argv[0] &lt;&lt; <span class="stringliteral">&quot; &lt;Input image&gt;&quot;</span> &lt;&lt; endl;</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        <span class="keywordflow">if</span> (args.length != 1) {</div>
<div class="line">            System.err.println(<span class="stringliteral">&quot;You must supply one argument that corresponds to the path to the image.&quot;</span>);</div>
<div class="line">            System.exit(0);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        Mat src = Imgcodecs.imread(args[0]);</div>
<div class="line">        <span class="keywordflow">if</span> (src.empty()) {</div>
<div class="line">            System.err.println(<span class="stringliteral">&quot;Empty image: &quot;</span> + args[0]);</div>
<div class="line">            System.exit(0);</div>
<div class="line">        }</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">parser = argparse.ArgumentParser(description=<span class="stringliteral">&#39;Code for Back Projection tutorial.&#39;</span>)</div>
<div class="line">parser.add_argument(<span class="stringliteral">&#39;--input&#39;</span>, help=<span class="stringliteral">&#39;Path to input image.&#39;</span>, default=<span class="stringliteral">&#39;home.jpg&#39;</span>)</div>
<div class="line">args = parser.parse_args()</div>
<div class="line"> </div>
<div class="line">src = <a class="code" href="../../d4/da8/group__imgcodecs.html#gacbaa02cffc4ec2422dfa2e24412a99e2">cv.imread</a>(<a class="code" href="../../d6/dba/group__core__utils__samples.html#ga3a33b00033b46c698ff6340d95569c13">cv.samples.findFile</a>(args.input))</div>
<div class="line"><span class="keywordflow">if</span> src <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line">    <a class="code" href="../../df/d57/namespacecv_1_1dnn.html#a43417dcaeb3c1e2a09b9d948e234c366">print</a>(<span class="stringliteral">&#39;Could not open or find the image:&#39;</span>, args.input)</div>
<div class="line">    exit(0)</div>
</div><!-- fragment --> </div> <ul>
<li>Transform it to HSV format:</li>
</ul>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    Mat hsv;</div>
<div class="line">    <a class="code" href="../../d8/d01/group__imgproc__color__conversions.html#gaf86c09fe702ed037c03c2bc603ceab14">cvtColor</a>( src, hsv, <a class="code" href="../../d8/d01/group__imgproc__color__conversions.html#gga4e0972be5de079fed4e3a10e24ef5ef0aa4a7f0ecf2e94150699e48c79139ee12">COLOR_BGR2HSV</a> );</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        Mat hsv = <span class="keyword">new</span> Mat();</div>
<div class="line">        Imgproc.cvtColor(src, hsv, Imgproc.COLOR_BGR2HSV);</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">hsv = <a class="code" href="../../d8/d01/group__imgproc__color__conversions.html#gaf86c09fe702ed037c03c2bc603ceab14">cv.cvtColor</a>(src, cv.COLOR_BGR2HSV)</div>
</div><!-- fragment --> </div> <ul>
<li>For this tutorial, we will use only the Hue value for our 1-D histogram (check out the fancier code in the links above if you want to use the more standard H-S histogram, which yields better results):</li>
</ul>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    hue.create(hsv.size(), hsv.depth());</div>
<div class="line">    <span class="keywordtype">int</span> ch[] = { 0, 0 };</div>
<div class="line">    <a class="code" href="../../d2/de8/group__core__array.html#ga51d768c270a1cdd3497255017c4504be">mixChannels</a>( &amp;hsv, 1, &amp;hue, 1, ch, 1 );</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        hue = <span class="keyword">new</span> Mat(hsv.size(), hsv.depth());</div>
<div class="line">        Core.mixChannels(Arrays.asList(hsv), Arrays.asList(hue), <span class="keyword">new</span> MatOfInt(0, 0));</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">ch = (0, 0)</div>
<div class="line">hue = np.empty(hsv.shape, hsv.dtype)</div>
<div class="line"><a class="code" href="../../d2/de8/group__core__array.html#ga51d768c270a1cdd3497255017c4504be">cv.mixChannels</a>([hsv], [hue], ch)</div>
</div><!-- fragment --> </div> <ul>
<li>as you see, we use the function <a class="el" href="../../d2/de8/group__core__array.html#ga51d768c270a1cdd3497255017c4504be">cv::mixChannels</a> to get only the channel 0 (Hue) from the hsv image. It gets the following parameters:<ul>
<li><b>&amp;hsv:</b> The source array from which the channels will be copied</li>
<li><b>1:</b> The number of source arrays</li>
<li><b>&amp;hue:</b> The destination array of the copied channels</li>
<li><b>1:</b> The number of destination arrays</li>
<li><b>ch[] = {0,0}:</b> The array of index pairs indicating how the channels are copied. In this case, the Hue(0) channel of &amp;hsv is being copied to the 0 channel of &amp;hue (1-channel)</li>
<li><b>1:</b> Number of index pairs</li>
</ul>
</li>
<li>Create a Trackbar for the user to enter the bin values. Any change on the Trackbar means a call to the <b>Hist_and_Backproj</b> callback function.</li>
</ul>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* window_image = <span class="stringliteral">&quot;Source image&quot;</span>;</div>
<div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga5afdf8410934fd099df85c75b2e0888b">namedWindow</a>( window_image );</div>
<div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#gaf78d2155d30b728fc413803745b67a9b">createTrackbar</a>(<span class="stringliteral">&quot;* Hue  bins: &quot;</span>, window_image, &amp;bins, 180, Hist_and_Backproj );</div>
<div class="line">    Hist_and_Backproj(0, 0);</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        JPanel sliderPanel = <span class="keyword">new</span> JPanel();</div>
<div class="line">        sliderPanel.setLayout(<span class="keyword">new</span> BoxLayout(sliderPanel, BoxLayout.PAGE_AXIS));</div>
<div class="line"> </div>
<div class="line">        sliderPanel.add(<span class="keyword">new</span> JLabel(<span class="stringliteral">&quot;* Hue  bins: &quot;</span>));</div>
<div class="line">        JSlider slider = <span class="keyword">new</span> JSlider(0, MAX_SLIDER, bins);</div>
<div class="line">        slider.setMajorTickSpacing(25);</div>
<div class="line">        slider.setMinorTickSpacing(5);</div>
<div class="line">        slider.setPaintTicks(<span class="keyword">true</span>);</div>
<div class="line">        slider.setPaintLabels(<span class="keyword">true</span>);</div>
<div class="line">        slider.addChangeListener(<span class="keyword">new</span> ChangeListener() {</div>
<div class="line">            @Override</div>
<div class="line">            <span class="keyword">public</span> <span class="keywordtype">void</span> stateChanged(ChangeEvent e) {</div>
<div class="line">                JSlider source = (JSlider) e.getSource();</div>
<div class="line">                bins = source.getValue();</div>
<div class="line">                update();</div>
<div class="line">            }</div>
<div class="line">        });</div>
<div class="line">        sliderPanel.add(slider);</div>
<div class="line">        pane.add(sliderPanel, BorderLayout.PAGE_START);</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">window_image = <span class="stringliteral">&#39;Source image&#39;</span></div>
<div class="line"><a class="code" href="../../d7/dfc/group__highgui.html#ga5afdf8410934fd099df85c75b2e0888b">cv.namedWindow</a>(window_image)</div>
<div class="line">bins = 25</div>
<div class="line"><a class="code" href="../../d7/dfc/group__highgui.html#gaf78d2155d30b728fc413803745b67a9b">cv.createTrackbar</a>(<span class="stringliteral">&#39;* Hue  bins: &#39;</span>, window_image, bins, 180, Hist_and_Backproj )</div>
<div class="line">Hist_and_Backproj(bins)</div>
</div><!-- fragment --> </div> <ul>
<li>Show the image and wait for the user to exit the program:</li>
</ul>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">imshow</a>( window_image, src );</div>
<div class="line">    <span class="comment">// Wait until user exits the program</span></div>
<div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga5628525ad33f52eab17feebcfba38bd7">waitKey</a>();</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        <span class="comment">// Use the content pane&#39;s default BorderLayout. No need for</span></div>
<div class="line">        <span class="comment">// setLayout(new BorderLayout());</span></div>
<div class="line">        <span class="comment">// Display the window.</span></div>
<div class="line">        frame.pack();</div>
<div class="line">        frame.setVisible(<span class="keyword">true</span>);</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line"><a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv.imshow</a>(window_image, src)</div>
<div class="line"><a class="code" href="../../d7/dfc/group__highgui.html#ga5628525ad33f52eab17feebcfba38bd7">cv.waitKey</a>()</div>
</div><!-- fragment --> </div> <ul>
<li><b>Hist_and_Backproj function:</b> Initialize the arguments needed for <a class="el" href="../../d6/dc7/group__imgproc__hist.html#ga4b2b5fd75503ff9e6844cc4dcdaed35d">cv::calcHist</a> . The number of bins comes from the Trackbar:</li>
</ul>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    <span class="keywordtype">int</span> histSize = <a class="code" href="../../db/de0/group__core__utils.html#gafa99ec4acc4ecb2dc3c2d05da15d0e3f">MAX</a>( bins, 2 );</div>
<div class="line">    <span class="keywordtype">float</span> hue_range[] = { 0, 180 };</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">float</span>* ranges[] = { hue_range };</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        <span class="keywordtype">int</span> histSize = Math.max(bins, 2);</div>
<div class="line">        <span class="keywordtype">float</span>[] hueRange = {0, 180};</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">    bins = val</div>
<div class="line">    histSize = <a class="code" href="../../d1/d10/classcv_1_1MatExpr.html#a6dff8b6e9105b6d817b493e7be157c90">max</a>(bins, 2)</div>
<div class="line">    ranges = [0, 180] <span class="comment"># hue_range</span></div>
</div><!-- fragment --> </div> <ul>
<li>Calculate the Histogram and normalize it to the range \([0,255]\)</li>
</ul>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    Mat hist;</div>
<div class="line">    <a class="code" href="../../d6/dc7/group__imgproc__hist.html#ga4b2b5fd75503ff9e6844cc4dcdaed35d">calcHist</a>( &amp;hue, 1, 0, Mat(), hist, 1, &amp;histSize, ranges, <span class="keyword">true</span>, <span class="keyword">false</span> );</div>
<div class="line">    <a class="code" href="../../dc/d84/group__core__basic.html#ga766333b5fb9fea02d355fa0e0ffbf7ac">normalize</a>( hist, hist, 0, 255, <a class="code" href="../../d2/de8/group__core__array.html#ggad12cefbcb5291cf958a85b4b67b6149fa9f0c1c342a18114d47b516a88e29822e">NORM_MINMAX</a>, -1, Mat() );</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        Mat hist = <span class="keyword">new</span> Mat();</div>
<div class="line">        List&lt;Mat&gt; hueList = Arrays.asList(hue);</div>
<div class="line">        Imgproc.calcHist(hueList, <span class="keyword">new</span> MatOfInt(0), <span class="keyword">new</span> Mat(), hist, <span class="keyword">new</span> MatOfInt(histSize), <span class="keyword">new</span> MatOfFloat(hueRange), <span class="keyword">false</span>);</div>
<div class="line">        Core.normalize(hist, hist, 0, 255, Core.NORM_MINMAX);</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">    hist = <a class="code" href="../../d6/dc7/group__imgproc__hist.html#ga4b2b5fd75503ff9e6844cc4dcdaed35d">cv.calcHist</a>([hue], [0], <span class="keywordtype">None</span>, [histSize], ranges, accumulate=<span class="keyword">False</span>)</div>
<div class="line">    <a class="code" href="../../dc/d84/group__core__basic.html#ga766333b5fb9fea02d355fa0e0ffbf7ac">cv.normalize</a>(hist, hist, alpha=0, beta=255, norm_type=cv.NORM_MINMAX)</div>
</div><!-- fragment --> </div> <ul>
<li>Get the Backprojection of the same image by calling the function <a class="el" href="../../d6/dc7/group__imgproc__hist.html#ga3a0af640716b456c3d14af8aee12e3ca">cv::calcBackProject</a></li>
</ul>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    Mat backproj;</div>
<div class="line">    <a class="code" href="../../d6/dc7/group__imgproc__hist.html#ga3a0af640716b456c3d14af8aee12e3ca">calcBackProject</a>( &amp;hue, 1, 0, hist, backproj, ranges, 1, <span class="keyword">true</span> );</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        Mat backproj = <span class="keyword">new</span> Mat();</div>
<div class="line">        Imgproc.calcBackProject(hueList, <span class="keyword">new</span> MatOfInt(0), hist, backproj, <span class="keyword">new</span> MatOfFloat(hueRange), 1);</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">    backproj = <a class="code" href="../../d6/dc7/group__imgproc__hist.html#ga3a0af640716b456c3d14af8aee12e3ca">cv.calcBackProject</a>([hue], [0], hist, ranges, scale=1)</div>
</div><!-- fragment --> </div> <ul>
<li>all the arguments are known (the same as used to calculate the histogram), only we add the backproj matrix, which will store the backprojection of the source image (&amp;hue)</li>
<li>Display backproj:</li>
</ul>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">imshow</a>( <span class="stringliteral">&quot;BackProj&quot;</span>, backproj );</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        Image backprojImg = HighGui.toBufferedImage(backproj);</div>
<div class="line">        backprojLabel.setIcon(<span class="keyword">new</span> ImageIcon(backprojImg));</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv.imshow</a>(<span class="stringliteral">&#39;BackProj&#39;</span>, backproj)</div>
</div><!-- fragment --> </div> <ul>
<li>Draw the 1-D Hue histogram of the image:</li>
</ul>
 <div class='newInnerHTML' title='cpp' style='display: none;'>C++</div><div class='toggleable_div label_cpp' style='display: none;'> <div class="fragment"><div class="line">    <span class="keywordtype">int</span> w = 400, h = 400;</div>
<div class="line">    <span class="keywordtype">int</span> bin_w = <a class="code" href="../../db/de0/group__core__utils.html#ga085eca238176984a0b72df2818598d85">cvRound</a>( (<span class="keywordtype">double</span>) w / histSize );</div>
<div class="line">    Mat histImg = Mat::zeros( h, w, <a class="code" href="../../d1/d1b/group__core__hal__interface.html#ga88c4cd9de76f678f33928ef1e3f96047">CV_8UC3</a> );</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; bins; i++)</div>
<div class="line">    {</div>
<div class="line">        <a class="code" href="../../d6/d6e/group__imgproc__draw.html#ga07d2f74cadcf8e305e810ce8eed13bc9">rectangle</a>( histImg, <a class="code" href="../../dc/d84/group__core__basic.html#ga1e83eafb2d26b3c93f09e8338bcab192">Point</a>( i*bin_w, h ), <a class="code" href="../../dc/d84/group__core__basic.html#ga1e83eafb2d26b3c93f09e8338bcab192">Point</a>( (i+1)*bin_w, h - <a class="code" href="../../db/de0/group__core__utils.html#ga085eca238176984a0b72df2818598d85">cvRound</a>( hist.at&lt;<span class="keywordtype">float</span>&gt;(i)*h/255.0 ) ),</div>
<div class="line">                   <a class="code" href="../../dc/d84/group__core__basic.html#ga599fe92e910c027be274233eccad7beb">Scalar</a>( 0, 0, 255 ), <a class="code" href="../../d6/d6e/group__imgproc__draw.html#ggaf076ef45de481ac96e0ab3dc2c29a777a89c5f6beef080e6df347167f85e07b9e">FILLED</a> );</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">imshow</a>( <span class="stringliteral">&quot;Histogram&quot;</span>, histImg );</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='java' style='display: none;'>Java</div><div class='toggleable_div label_java' style='display: none;'> <div class="fragment"><div class="line">        <span class="keywordtype">int</span> w = 400, h = 400;</div>
<div class="line">        <span class="keywordtype">int</span> binW = (int) Math.round((<span class="keywordtype">double</span>) w / histSize);</div>
<div class="line">        histImg = Mat.zeros(h, w, CvType.CV_8UC3);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">float</span>[] histData = <span class="keyword">new</span> <span class="keywordtype">float</span>[(int) (hist.total() * hist.channels())];</div>
<div class="line">        hist.get(0, 0, histData);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; bins; i++) {</div>
<div class="line">            Imgproc.rectangle(histImg, <span class="keyword">new</span> <a class="code" href="../../dc/d84/group__core__basic.html#ga1e83eafb2d26b3c93f09e8338bcab192">Point</a>(i * binW, h),</div>
<div class="line">                    <span class="keyword">new</span> <a class="code" href="../../dc/d84/group__core__basic.html#ga1e83eafb2d26b3c93f09e8338bcab192">Point</a>((i + 1) * binW, h - Math.round(histData[i] * h / 255.0)), <span class="keyword">new</span> <a class="code" href="../../dc/d84/group__core__basic.html#ga599fe92e910c027be274233eccad7beb">Scalar</a>(0, 0, 255), Imgproc.FILLED);</div>
<div class="line">        }</div>
<div class="line">        Image histImage = HighGui.toBufferedImage(histImg);</div>
<div class="line">        histImgLabel.setIcon(<span class="keyword">new</span> ImageIcon(histImage));</div>
</div><!-- fragment --> </div>  <div class='newInnerHTML' title='python' style='display: none;'>Python</div><div class='toggleable_div label_python' style='display: none;'> <div class="fragment"><div class="line">    w = 400</div>
<div class="line">    h = 400</div>
<div class="line">    bin_w = int(round(w / histSize))</div>
<div class="line">    histImg = np.zeros((h, w, 3), dtype=np.uint8)</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(bins):</div>
<div class="line">        <a class="code" href="../../d6/d6e/group__imgproc__draw.html#ga07d2f74cadcf8e305e810ce8eed13bc9">cv.rectangle</a>(histImg, (i*bin_w, h), ( (i+1)*bin_w, h - int(np.round( hist[i]*h/255.0 )) ), (0, 0, 255), cv.FILLED)</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="../../d7/dfc/group__highgui.html#ga453d42fe4cb60e5723281a89973ee563">cv.imshow</a>(<span class="stringliteral">&#39;Histogram&#39;</span>, histImg)</div>
</div><!-- fragment --> </div> <h1><a class="anchor" id="autotoc_md449"></a>
Results</h1>
<p>Here are the output by using a sample image ( guess what? Another hand ). You can play with the bin values and you will observe how it affects the results: <img src="../../Back_Projection1_Source_Image.jpg" alt="" class="inline" title="R0"/> <img src="../../Back_Projection1_Histogram.jpg" alt="" class="inline" title="R1"/> <img src="../../Back_Projection1_BackProj.jpg" alt="" class="inline" title="R2"/> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.9.1
</small></address>
<script type="text/javascript">
//<![CDATA[
addTutorialsButtons();
//]]>
</script>
</body>
</html>
